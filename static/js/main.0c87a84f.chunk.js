(this["webpackJsonptooter-web"]=this["webpackJsonptooter-web"]||[]).push([[0],{13:function(e,t,o){},14:function(e,t,o){"use strict";o.r(t);var n=o(7),a=o(0),c=o.n(a),r=o(5),s=o.n(r),i=(o(13),o(2)),l=o(1);function u(e){var t=e.tootId,o=Object(a.useState)(!1),n=Object(l.a)(o,2),r=n[0],s=n[1],i=Object(a.useState)(null),u=Object(l.a)(i,2),d=u[0],f=u[1],b=function(e,t){200===t?f(e):alert("There was an error finding your toot!")};return Object(a.useEffect)((function(){var e;!1===r&&(e=b,m("GET","toots/".concat(t,"/"),e),s(!0))}),[t,r,s]),null!==d?c.a.createElement(p,{isDetail:!0,toot:d,className:e.className}):null}function m(e,t,o,n){var a;n&&(a=JSON.stringify(n));var c=new XMLHttpRequest,r="http://localhost:8000/api/".concat(t),s=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var a=o[n].trim();if(a.substring(0,e.length+1)===e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t}("csrftoken");c.responseType="json",c.open(e,r),c.setRequestHeader("Content-Type","application/json"),s&&(c.setRequestHeader("HTTP_X_REQUESTED_WITH","XMLHttpRequest"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("X-CSRFToken",s)),c.onload=function(){if(403===c.status){var e=c.response.detail;console.log(c.response.detail),"Authentication credentials were not provided."===e&&(window.location.href="/login?showLoginRequired=true")}o(c.response,c.status)},c.onerror=function(e){console.log(e),o({message:"The request was an error"},400)},c.send(a)}function d(e){var t=e.toot,o=e.action,n=e.didPerformAction,a=t.likeCount?t.likeCount:0,r=e.className?e.className:"btn btn-primary btn-sm",s=o.display?o.display:"Action",i="like"===o.type?"".concat(a," ").concat(s):s,l=function(e,t){200!==t&&201!==t||!n||n(e,t)};return c.a.createElement("button",{className:r,onClick:function(e){e.preventDefault(),function(e,t,o){m("POST","toots/action/",o,{id:e,action:t})}(t.id,o.type,l)}},i)}function f(e){var t=Object(a.useState)([]),o=Object(l.a)(t,2),n=o[0],r=o[1],s=Object(a.useState)([]),u=Object(l.a)(s,2),d=u[0],f=u[1],b=Object(a.useState)(!1),v=Object(l.a)(b,2),E=v[0],h=v[1];Object(a.useEffect)((function(){var t=Object(i.a)(e.newToots).concat(n);t.length!==d.length&&f(t)}),[e.newToots,n,d]),Object(a.useEffect)((function(){if(!1===E){!function(e,t){var o="toots/";e&&(o="toots/?username=".concat(e)),m("GET",o,t)}(e.username,(function(e,t){200===t?(r(e),h(!0)):alert(e.message)}))}}),[n,E,h,e.username]);var O=function(e){var t=Object(i.a)(n);t.unshift(e),r(t),console.log(t);var o=Object(i.a)(d);o.unshift(d),f(o),console.log(o)};return d.map((function(e,t){return c.a.createElement(p,{toot:e,didRetoot:O,className:"col-10 mx-auto my-5 py-5 border rounded bg-white text-dark",key:t})}))}function b(e){var t=e.toot;return t.parent?c.a.createElement("div",{className:"row"},c.a.createElement("p",{className:"col-11 p-3 mx-auto mb-0 text-muted small"},"Retoot"),c.a.createElement(p,{hideAction:!0,className:"col-11 p-3 mx-auto border rounded",toot:t.parent})):null}function p(e){var t=e.toot,o=e.didRetoot,n=e.hideAction,r=e.isDetail,s=Object(a.useState)(e.toot?e.toot:null),i=Object(l.a)(s,2),u=i[0],m=i[1],f=e.className?e.className:"col-10 mx-auto col-md-6",p=Object(a.useState)(!1),v=Object(l.a)(p,2),E=v[0],h=v[1],O=function(e,t){200===t?m(e):o&&(o(e),h(!E))};return Object(a.useEffect)((function(){m(e.toot)}),[e.toot,E]),c.a.createElement("div",{className:f},c.a.createElement("div",null,c.a.createElement("p",{className:"small"},t.id),c.a.createElement("p",null,t.content),c.a.createElement(b,{toot:t})),c.a.createElement("div",{className:"btn btn-group"},u&&!0!==n&&c.a.createElement(c.a.Fragment,null,c.a.createElement(d,{toot:u,didPerformAction:O,action:{type:"like",display:"Likes"}}),c.a.createElement(d,{toot:u,didPerformAction:O,action:{type:"unlike",display:"Unlike"}}),c.a.createElement(d,{toot:u,didPerformAction:O,action:{type:"retoot",display:"Retoot"}})),r?null:c.a.createElement("button",{className:"btn btn-outline-primary btn-sm",onClick:function(e){e.preventDefault(),window.location.href="/".concat(t.id)}},"View Toot")))}function v(e){var t=c.a.createRef(),o=e.didToot,n=function(e,t){201===t?o(e):alert("Your toot cannot be created")};return c.a.createElement("div",{className:e.className},c.a.createElement("form",{className:"form",id:"toot-create-form",onSubmit:function(e){e.preventDefault();var o=t.current.value;m("POST","toots/create/",n,{content:o}),t.current.value=""}},c.a.createElement("textarea",{ref:t,required:!0,className:"form-control",name:"content",placeholder:"What is your toot today?"}),c.a.createElement("button",{type:"submit",className:"btn btn-primary my-3"},"Toot")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=c.a.createElement,h=document.getElementById("tooter");h&&s.a.render(E((function(e){var t="true"===e.canToot,o=Object(a.useState)([]),n=Object(l.a)(o,2),r=n[0],s=n[1];return c.a.createElement("div",{className:e.className},t&&c.a.createElement(v,{className:"col-12 mb-3",didToot:function(e){var t=Object(i.a)(r);t.unshift(e),s(t)}}),c.a.createElement(f,Object.assign({},e,{newToots:r})))}),h.dataset),h),document.querySelectorAll(".tooter-detail").forEach((function(e){if(e){var t=window.location.pathname,o=Object(n.a)(/([0-9]+)/,{tootId:1}),a=t.match(o);if(a){var c=a.groups.tootId;e.setAttribute("data-toot-id",c),s.a.render(E(u,e.dataset),e)}}})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,o){e.exports=o(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.0c87a84f.chunk.js.map