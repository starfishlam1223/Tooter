(this["webpackJsonptooter-web"]=this["webpackJsonptooter-web"]||[]).push([[0],{13:function(t,e,o){},14:function(t,e,o){"use strict";o.r(e);var n=o(7),a=o(0),c=o.n(a),r=o(5),s=o.n(r),i=(o(13),o(2)),l=o(1);function u(t){var e=t.tootId,o=Object(a.useState)(!1),n=Object(l.a)(o,2),r=n[0],s=n[1],i=Object(a.useState)(null),u=Object(l.a)(i,2),d=u[0],f=u[1],b=function(t,e){200===e?f(t):alert("There was an error finding your toot!")};return Object(a.useEffect)((function(){var t;!1===r&&(t=b,m("GET","toots/".concat(e,"/"),t),s(!0))}),[e,r,s]),null!==d?c.a.createElement(p,{isDetail:!0,toot:d,className:t.className}):null}function m(t,e,o,n){var a;n&&(a=JSON.stringify(n));var c=new XMLHttpRequest,r="http://localhost:8000/api/".concat(e),s=function(t){var e=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),n=0;n<o.length;n++){var a=o[n].trim();if(a.substring(0,t.length+1)===t+"="){e=decodeURIComponent(a.substring(t.length+1));break}}return e}("csrftoken");c.responseType="json",c.open(t,r),c.setRequestHeader("Content-Type","application/json"),s&&(c.setRequestHeader("HTTP_X_REQUESTED_WITH","XMLHttpRequest"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("X-CSRFToken",s)),c.onload=function(){o(c.response,c.status)},c.onerror=function(t){console.log(t),o({message:"The request was an error"},400)},c.send(a)}function d(t){var e=t.toot,o=t.action,n=t.didPerformAction,a=e.likeCount?e.likeCount:0,r=t.className?t.className:"btn btn-primary btn-sm",s=o.display?o.display:"Action",i="like"===o.type?"".concat(a," ").concat(s):s,l=function(t,e){200!==e&&201!==e||!n||n(t,e)};return c.a.createElement("button",{className:r,onClick:function(t){t.preventDefault(),function(t,e,o){m("POST","toots/action/",o,{id:t,action:e})}(e.id,o.type,l)}},i)}function f(t){var e=Object(a.useState)([]),o=Object(l.a)(e,2),n=o[0],r=o[1],s=Object(a.useState)([]),u=Object(l.a)(s,2),d=u[0],f=u[1],b=Object(a.useState)(!1),v=Object(l.a)(b,2),E=v[0],h=v[1];Object(a.useEffect)((function(){var e=Object(i.a)(t.newToots).concat(n);e.length!==d.length&&f(e)}),[t.newToots,n,d]),Object(a.useEffect)((function(){if(!1===E){!function(t,e){var o="toots/";t&&(o="toots/?username=".concat(t)),m("GET",o,e)}(t.username,(function(t,e){200===e?(r(t),h(!0)):alert(t.message)}))}}),[n,E,h,t.username]);var y=function(t){var e=Object(i.a)(n);e.unshift(t),r(e),console.log(e);var o=Object(i.a)(d);o.unshift(d),f(o),console.log(o)};return d.map((function(t,e){return c.a.createElement(p,{toot:t,didRetoot:y,className:"col-10 mx-auto my-5 py-5 border rounded bg-white text-dark",key:e})}))}function b(t){var e=t.toot;return e.parent?c.a.createElement("div",{className:"row"},c.a.createElement("p",{className:"col-11 p-3 mx-auto mb-0 text-muted small"},"Retoot"),c.a.createElement(p,{hideAction:!0,className:"col-11 p-3 mx-auto border rounded",toot:e.parent})):null}function p(t){var e=t.toot,o=t.didRetoot,n=t.hideAction,r=t.isDetail,s=Object(a.useState)(t.toot?t.toot:null),i=Object(l.a)(s,2),u=i[0],m=i[1],f=t.className?t.className:"col-10 mx-auto col-md-6",p=function(e,n){200===n?m(e):o&&(console.log(e),console.log(t.toot),o(e),m(t.toot))};return Object(a.useEffect)((function(){m(t.toot)}),[t.toot,u]),c.a.createElement("div",{className:f},c.a.createElement("div",null,c.a.createElement("p",{className:"small"},e.id),c.a.createElement("p",null,e.content),c.a.createElement(b,{toot:e})),c.a.createElement("div",{className:"btn btn-group"},u&&!0!==n&&c.a.createElement(c.a.Fragment,null,c.a.createElement(d,{toot:u,didPerformAction:p,action:{type:"like",display:"Likes"}}),c.a.createElement(d,{toot:u,didPerformAction:p,action:{type:"unlike",display:"Unlike"}}),c.a.createElement(d,{toot:u,didPerformAction:p,action:{type:"retoot",display:"Retoot"}})),r?null:c.a.createElement("button",{className:"btn btn-outline-primary btn-sm",onClick:function(t){t.preventDefault(),window.location.href="/".concat(e.id)}},"View Toot")))}function v(t){var e=c.a.createRef(),o=t.didToot,n=function(t,e){201===e?o(t):alert("Your toot cannot be created")};return c.a.createElement("div",{className:t.className},c.a.createElement("form",{className:"form",id:"toot-create-form",onSubmit:function(t){t.preventDefault();var o=e.current.value;m("POST","toots/create/",n,{content:o}),e.current.value=""}},c.a.createElement("textarea",{ref:e,required:!0,className:"form-control",name:"content",placeholder:"What is your toot today?"}),c.a.createElement("button",{type:"submit",className:"btn btn-primary my-3"},"Toot")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=c.a.createElement,h=document.getElementById("tooter");h&&s.a.render(E((function(t){var e="true"===t.canToot,o=Object(a.useState)([]),n=Object(l.a)(o,2),r=n[0],s=n[1];return c.a.createElement("div",{className:t.className},e&&c.a.createElement(v,{className:"col-12 mb-3",didToot:function(t){var e=Object(i.a)(r);e.unshift(t),s(e)}}),c.a.createElement(f,Object.assign({},t,{newToots:r})))}),h.dataset),h),document.querySelectorAll(".tooter-detail").forEach((function(t){if(t){var e=window.location.pathname,o=Object(n.a)(/([0-9]+)/,{tootId:1}),a=e.match(o);if(a){var c=a.groups.tootId;t.setAttribute("data-toot-id",c),s.a.render(E(u,t.dataset),t)}}})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},8:function(t,e,o){t.exports=o(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.e005b626.chunk.js.map